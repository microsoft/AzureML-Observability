{"$schema":"https://dataexplorer.azure.com/static/d/schema/24/dashboard.json","id":"56fa7d0b-9158-4f64-b514-58c5622260eb","eTag":"YJd263JzElH9T56pEZn+wg==","title":"drift_detection","tiles":[{"id":"67f90ef9-0789-4954-ab99-8814874e7760","title":"Scaled Drift Score","query":"\ndrift_analysis_result|where run_id == run_id_param|summarize  overall_drift= avg(toreal(scaled_metric)) by target_start_date |order by todatetime(target_start_date) asc","dataSourceId":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","visualType":"line","pageId":"7c16281b-eaa8-488c-86ce-9078fd4fe0ab","layout":{"x":0,"y":0,"width":24,"height":6},"usedParamVariables":["run_id_param"],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"Drift score","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"specified","value":"target_start_date"},"yColumns":{"type":"specified","value":["overall_drift"]},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[{"interaction":"column","property":"target_start_date","parameterId":"57c8ba44-f98d-4863-8e21-856a76f268d2","disabled":false}],"drillthrough":[]}},{"id":"3ae5bc3d-cd20-4af6-8908-d6636c87ae3a","title":"Feature Value Distribution (target)","query":"\nfeature_distribution\n|where feature == feature_name and ['datetime'] == start_date and run_id==run_id_param\n|mv-expand value=parse_json(value_list) to typeof(string ), count=parse_json(count_list) to typeof(real )\n|project value, ['count'], feature_name ","dataSourceId":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","visualType":"column","pageId":"7c16281b-eaa8-488c-86ce-9078fd4fe0ab","layout":{"x":11,"y":15,"width":13,"height":8},"usedParamVariables":["feature_name","run_id_param","start_date"],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"766b1648-4ab0-4555-8f01-2de950efaa51","title":"Feature details","query":"drift_analysis_result| where run_id == run_id_param\n| summarize  avg(toreal(column_ifexists(metric,\"none\"))) by target_start_date| order by todatetime(target_start_date)","dataSourceId":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","visualType":"line","pageId":"c2f0e928-c30a-4e4e-a3f7-34ce84e8e1e5","layout":{"x":0,"y":0,"width":23,"height":18},"usedParamVariables":["metric","run_id_param"],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"specified","value":"target_start_date"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"bc25ae53-4968-4a21-a003-3c8f39c1886b","title":"Feature Detail","query":"let tbl2= drift_analysis_result | where target_start_date == start_date and run_id == run_id_param| summarize base_dcount= avg(toreal(base_dcount)), target_dcount= avg(toreal(target_dcount)),euclidean=avg(toreal(euclidean)) by categorical_feature| project feature = categorical_feature, base_dcount, target_dcount,euclidean;\nlet tbl1= drift_analysis_result | where target_start_date == start_date and run_id == run_id_param| summarize base_min= avg(toreal(base_min)), target_min= avg(toreal(target_min)),base_max=avg(toreal(base_max)), target_max=avg(toreal(target_max)),base_mean=avg(toreal(base_mean)),target_mean=avg(toreal(target_mean)), wassertstein = avg(toreal(wasserstein)) by numeric_feature| project feature = numeric_feature, base_min, target_min, base_max, target_max, base_mean, target_mean, wassertstein;\ntbl1|union tbl2\n| sort by wassertstein\n\n\n","dataSourceId":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","visualType":"table","pageId":"7c16281b-eaa8-488c-86ce-9078fd4fe0ab","layout":{"x":0,"y":23,"width":24,"height":9},"usedParamVariables":["run_id_param","start_date"],"visualOptions":{"hideTileTitle":false,"table__enableRenderLinks":true,"table__renderLinksForColumns":[],"colorRules":[],"colorRulesDisabled":false,"colorStyle":"bold","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"8b5a3b20-333d-4b10-8ce8-cab50808f1c5","title":"Wasserstein distance for numerical features","query":"\ndrift_analysis_result|where run_id == run_id_param| where numeric_feature!=\"\"\n|summarize  wasserstein= avg(toreal(wasserstein)) by target_start_date,numeric_feature |order by todatetime(target_start_date) asc","dataSourceId":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","visualType":"stackedcolumn","pageId":"7c16281b-eaa8-488c-86ce-9078fd4fe0ab","layout":{"x":0,"y":6,"width":11,"height":9},"usedParamVariables":["run_id_param"],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"specified","value":"target_start_date"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[{"interaction":"column","property":"numeric_feature","parameterId":"4a757dd0-2916-4d64-989d-79c1bf57bac1","disabled":false},{"interaction":"column","property":"target_start_date","parameterId":"57c8ba44-f98d-4863-8e21-856a76f268d2","disabled":false}],"drillthrough":[]}},{"id":"9beddeeb-1f45-41a4-85a6-aaa4318cdfaf","title":"Euclidean distance for categorical features","query":"\ndrift_analysis_result|where run_id == run_id_param| where categorical_feature!=\"\"\n|summarize  euclidean= avg(toreal(euclidean)) by target_start_date, categorical_feature |order by todatetime(target_start_date) asc","dataSourceId":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","visualType":"stackedcolumn","pageId":"7c16281b-eaa8-488c-86ce-9078fd4fe0ab","layout":{"x":11,"y":6,"width":13,"height":9},"usedParamVariables":["run_id_param"],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[{"interaction":"column","property":"categorical_feature","parameterId":"4a757dd0-2916-4d64-989d-79c1bf57bac1","disabled":false},{"interaction":"column","property":"target_start_date","parameterId":"57c8ba44-f98d-4863-8e21-856a76f268d2","disabled":false}],"drillthrough":[]}},{"id":"fc8d1322-0663-4a43-95f7-affb4ce69bfc","title":"Feature Distribution (base)","query":"let base_start_date = feature_distribution\n|where feature == feature_name and run_id==run_id_param\n|summarize base_start_date = min(['datetime']);\nfeature_distribution\n| where feature == feature_name and run_id==run_id_param and ['datetime'] == toscalar(base_start_date)\n|mv-expand value=parse_json(value_list) to typeof(string ), count=parse_json(count_list) to typeof(real )\n|project value, ['count'], feature_name ","dataSourceId":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","visualType":"column","pageId":"7c16281b-eaa8-488c-86ce-9078fd4fe0ab","layout":{"x":0,"y":15,"width":11,"height":8},"usedParamVariables":["feature_name","run_id_param"],"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}}],"dataSources":[{"id":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","name":"db01","clusterUri":"https://adx02.westus2.kusto.windows.net/","database":"db01","kind":"manual-kusto","scopeId":"kusto"}],"schema_version":"24","autoRefresh":{"enabled":false},"parameters":[{"kind":"string","id":"212933b6-2f27-4929-bb49-4dee3dbf62e0","displayName":"base_table","variableName":"base_table","selectionType":"single-all","defaultValue":{"kind":"value","value":"ISDWeather"},"dataSource":{"kind":"query","consumedVariables":[],"query":"\ndrift_analysis_result| extend base_table = split(run_id,\"_\")[0]| project tostring(base_table)| distinct base_table","dataSourceId":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","columns":{"value":"base_table"}},"showOnPages":{"kind":"all"}},{"kind":"string","id":"b86c01f4-1574-4495-b578-97763fe7b3bc","displayName":"target_table","variableName":"target_table","selectionType":"single","defaultValue":{"kind":"value","value":"ISDWeather"},"dataSource":{"kind":"query","consumedVariables":[],"query":"\n drift_analysis_result| extend target_table = split(run_id,\"_\")[1]| project tostring(target_table)| distinct target_table","dataSourceId":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","columns":{"value":"target_table"}},"showOnPages":{"kind":"all"}},{"kind":"string","id":"d1b87660-c17c-4724-ada3-6470765e23aa","displayName":"run_id","variableName":"run_id_param","selectionType":"single-all","defaultValue":{"kind":"value","value":"ISDWeather_ISDWeather_1654554713"},"dataSource":{"kind":"query","consumedVariables":["base_table","target_table"],"query":"drift_analysis_result| distinct run_id | sort by run_id desc  \n|where split(run_id,\"_\")[0] contains base_table and split(run_id,\"_\")[1] contains  target_table | distinct run_id | sort by run_id desc  \n","dataSourceId":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","columns":{"value":"run_id"}},"showOnPages":{"kind":"all"}},{"kind":"string","id":"57c8ba44-f98d-4863-8e21-856a76f268d2","displayName":"start_date","variableName":"start_date","selectionType":"single","defaultValue":{"kind":"value","value":"0100-01-01T07:52:58"},"dataSource":{"kind":"static","values":[{"value":"0100-01-01T07:52:58"}]},"showOnPages":{"kind":"all"}},{"kind":"string","id":"4a757dd0-2916-4d64-989d-79c1bf57bac1","displayName":"feature","variableName":"feature_name","selectionType":"single","defaultValue":{"kind":"value","value":"usaf"},"dataSource":{"kind":"query","consumedVariables":[],"query":"// Please enter your KQL query (Example):\n// <table name>\n// | where isempty(['run_id_param']) or <column name> == ['run_id_param'] // Single selection filtering\n// | where isempty(['start_date']) or <column name> == ['start_date'] // Single selection filtering\n// | take 100\nlet tbl1= data_drift_result | distinct numeric_feature|project feature =numeric_feature;\nlet tbl2= data_drift_result | distinct categorical_feature |project feature =categorical_feature;\ntbl1|union tbl2\n \n","dataSourceId":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","columns":{"value":"feature"}},"showOnPages":{"kind":"all"}},{"kind":"string","id":"99846391-56ca-486b-aab0-d762d29953a3","displayName":"metric","variableName":"metric","selectionType":"single-all","defaultValue":{"kind":"value","value":"euclidean"},"dataSource":{"kind":"query","consumedVariables":["feature_name"],"query":"let num_features = data_drift_result|distinct numeric_feature|project feature = numeric_feature|extend type =\"numerical\";\nlet cat_features = data_drift_result|distinct categorical_feature|project feature = categorical_feature|extend type =\"categorical\";\nlet feature_dict = num_features|union cat_features;\nlet type_out = toscalar(feature_dict|where feature == feature_name|project type);\nlet metrics_dict = datatable(metric:string, type: string)['euclidean', 'categorical',  \"target_dcount\",'categorical', \"target_min\", 'numerical',\"target_max\", 'numerical', \"target_mean\", 'numerical', \"wasserstein\", 'numerical'];\nmetrics_dict|where type == type_out| project metric\n","dataSourceId":"7b496ad1-5512-409d-b6b8-c4a64d5a27a6","columns":{"value":"metric"}},"showOnPages":{"kind":"all"}}],"pages":[{"name":"Drift Overview","id":"7c16281b-eaa8-488c-86ce-9078fd4fe0ab"},{"name":"Feature Detail","id":"c2f0e928-c30a-4e4e-a3f7-34ce84e8e1e5"}]}